---
title: "Summary of Two Quantitative Variables"
date: "February 20, 2025"
output:
  xaringan::moon_reader:
    css: "myCSS.css"
    chakra: "remark-latest.min.js"
    self_contained: true
    nature:
      countIncrementalSlides: false
---

### The Scatterplot

--

For each observation, the scatterplot displays the relationship between TWO QUANTITATIVE variables. 

--

The coordinates of each point are determined by these variables. 

--

For example, display the scatterplot for the variables wt and mpg in **mtcars**.

--


> Step 1: Open R GUI. Type in R Console *library(Rcmdr)*

> Step 2: Open data. Click on DATA > DATA IN PACKAGES > Read data set from attached package > Enter name of data set: **mtcars**. Click OK.

> Step 3: Click on GRAPHS > SCATTERPLOT 

> Step 4: Choose **wt** in x-variable and **mpg** in y-variable. Then click OK. 

---

**Observations**


- The variable **wt** is in the horizontal axis and **mpg** in the vertical axis.

- The variable plotted in the horizontal axis is known as **explanatory** (or independent) variable. 

- The variable in the vertical axis is known as the **response** (or dependent) variable.


---

### Description of the Scatterplot 

--

*Trend*: Linear or Nonlinear (bent)

--


```{r comment=NA, echo=FALSE, fig.align='center', fig.height=4, message=FALSE}

library(tidyverse)

x <- rep(1:10, 2)
y <- c(0,2.1,2.5,3.4,5.2,5.5,6.2,6.8,7.5,8.1,runif(10,1,10))
z <- factor(rep(1:2,each=10), labels=c("Linear", "Nonlinear"))

df <- data.frame(x, y, z)

ggplot(data=df, aes(x = x, y = y)) +
  geom_point(cex=2) +
  facet_wrap(~z, nrow=1) +
  theme_bw() +
  theme(
    axis.title = element_blank(),
    axis.text = element_blank()
  )


```

---

*Direction* (Linear case): Positive, Negative, or Null

--


Two variables are "positively" associated if, whenever the values of one variable increases, the values of the other also increases. They are "negatively" associated if, whenever the values of one variable increases, the other decreases.

--

```{r comment=NA, echo=FALSE, fig.align='center', fig.height=4, message=FALSE}

library(tidyverse)

x <- rep(1:10, 3)
y <- c(0,2.1,2.5,3.4,5.2,5.5,6.2,6.5,7.8,8.1,10,9.1,7.5,6.7,5.2,4.5,4.2,4.5,3.8,2.1, runif(10,1,10))
z <- factor(rep(1:3,each=10), labels=c("Positive", "Negative", "Null"))

df <- data.frame(x, y, z)

ggplot(data=df, aes(x = x, y = y)) +
  geom_point(cex=2) +
  facet_wrap(~z, nrow=1) +
  theme_bw() +
  theme(
    axis.title = element_blank(),
    axis.text = element_blank()
  )


```

---

*Strength* (Linear case): Strong, Moderate, Weak

--

```{r comment=NA, echo=FALSE, fig.align='center', message=FALSE, fig.height=4}

library(tidyverse)

x <- rep(1:10, 3)
a <- c(0,2.1,2.5,3.4,5.2,5.5,6.2,6.8,7.5,8.1)
y <- c(0,2.1,2.5,3.4,5.2,5.5,6.2,6.8,7.5,8.1, 2,-1.1,2.5,0.4,5.8,3.5,7.2,4.6,6.5,8.3, 2,-2.1,2.1,-3.4,5.8,-3.5,7.2,4.6,6.5,4.1)
z <- factor(rep(1:3,each=10), labels=c("Strong", "Moderate", "Weak"))

df <- data.frame(x, y, z)

ggplot(data=df, aes(x = x, y = y)) +
  geom_point(cex=2) +
  facet_wrap(~z, nrow=1) +
  theme_bw() +
  theme(
    axis.title = element_blank(),
    axis.text = element_blank()
  )


```

---


*Exercise:* Make a scatterplot for the variables *waiting* and *eruptions* in the data frame **faithful**. Describe your results.

--

- If R GUI is opened (step 1), follow step 2 and change Enter name of data set to **faithful**.

- Follow step 3. Follow step 4 by choosing **waiting** in x-variable and **eruptions** in y-variable.

---

```{r comment=NA, echo=F, fig.align='center', fig.height=6}

plot(eruptions ~ waiting, data = faithful)

```

--

**Description:** There is a strong positive linear association between waiting and eruption time of the Old Faithful. On average, the longer the tourist waits for the next eruption, the longer the eruption tends to last.

---

Additional to the X and Y variables in **plot()**, you have the option to add labels to each axis and a title to the plot. In addition, You can customize the points in the scatterplot by changing shape and color.



--

In step 4, choose the **OPTIONS** tab to change the axes labels and add graph title.

--

```{r comment=NA, echo=F, fig.align='center', fig.height=6}

plot(eruptions ~ waiting, data = faithful, xlab="Waiting Time (mins)", ylab="Eruption Time (mins)", 
     main = "Waiting vs Eruption Time in Old Faithful", pch=19, col="red")

```


---

### The Correlation Coefficient (r) 

--


- The correlation coefficient measures the **LINEAR** association between two quantitative variables, x and y.

--

- Formula: r = $\frac{\sum(Zx_i Zy_i)}{n - 1}$; $Zx_i$ and $Zy_i$ are the z-scores of X and Y respectively. The "population" correlation is denoted by $\rho$ (rho).

--

- The correlation coefficient is a number between -1 and 1 with no units (scaleless). A value **r** = 0 implies "little or no linear" association between x and y. The closer **r** is to -1 or 1, the stronger the linear relationship.

--

- The sign of the correlation coefficient indicates the direction of the association. 

--

**Warning about correlation:** We cannot infer causal relationship on the basis of high sample correlation. High correlation DOES NOT imply causality; unless, your data is "experimental." When a high correlation is observed in the sample data, the only safe conclusion is that the linear trend may exist between x and y. Remember that correlation measures the extent of linear association, but association does not imply causation.

---


```{r comment=NA, echo=FALSE, fig.align='center', fig.height=6, message=FALSE, warning=FALSE}


library(MASS)
library(tidyverse)

mu1 <- 0
mu2 <- 1
var1 <- 1
var2 <- 3

rho <- 0.15
covmat <- matrix(c(var1, rho*sqrt(var1*var2), rho*sqrt(var1*var2), var2),2)
sample1 <- as.data.frame(mvrnorm(100, c(mu1, mu2), covmat))

rho <- 0.45
covmat <- matrix(c(var1, rho*sqrt(var1*var2), rho*sqrt(var1*var2), var2),2)
sample2 <- as.data.frame(mvrnorm(100, c(mu1, mu2), covmat))

rho <- 0.75
covmat <- matrix(c(var1, rho*sqrt(var1*var2), rho*sqrt(var1*var2), var2),2)
sample3 <- as.data.frame(mvrnorm(100, c(mu1, mu2), covmat))

rho <- 0.95
covmat <- matrix(c(var1, rho*sqrt(var1*var2), rho*sqrt(var1*var2), var2),2)
sample4 <- as.data.frame(mvrnorm(100, c(mu1, mu2), covmat))

sample1 <- sample1 %>% mutate(type = 1)
sample2 <- sample2 %>% mutate(type = 2)
sample3 <- sample3 %>% mutate(type = 3)
sample4 <- sample4 %>% mutate(type = 4)


df <- rbind(sample1, sample2, sample3, sample4) %>%
  mutate(type = factor(type, labels=c("r = 0.15", "r = 0.45", "r = 0.75", "r = 0.95")))

df %>% 
  ggplot(aes(x = V1, y = V2)) +
  facet_wrap(~type, nrow = 2) +
  #geom_hline(yintercept = 1, lty=2, col="blue") +
  #geom_vline(xintercept = 0, lty=2, col="red") +
  geom_point() +
  theme(
    strip.text = element_text(size=14, face="bold"),
    axis.title = element_blank(),
    axis.text = element_blank()
  ) +
  labs(x = "\nX", y = "Y\n") +
  lims(x = c(-5,5), y = c(-7,7))


```


---


**Computing the Correlation Coefficient in R**

--


*a)* Compute the coefficient of correlation between cars' weight (wt) and fuel efficiency (mpg) in **mtcars**.

--

- Step 5: Click on STATISTICS > SUMMARIES > CORRELATION MATRIX

- Step 6: Choose the **wt** and **mpg** variables. Make the selection by pressing the **Ctrl** key in the keyboard and the left button in the mouse. Click OK.

```{r comment=NA, echo=F}

cor(mtcars$mpg, mtcars$wt)

```

--

*b)* Recompute the correlation by switching the arguments in **cor()**. Did you get a different result?

--

- The order of the variables selection will not change the value of the correlation coefficient.


```{r comment=NA, echo=F}

cor(mtcars$wt, mtcars$mpg)

```


---

*c)* Convert the cars' weight to Kilograms (1 pound = 0.4536 Kg), and recompute the correlation coefficient. What effect did the conversion from 1000-lbs to Kilogram have on the correlation coefficient? *(Hint: The variable wt is in 1000-lbs, so 1.65 = 1650 lbs)*

--

- Make sure **mtcars** is the active data set.

- Click on DATA > Manage variables in active data set > Compute new variable

- Choose a new variable name, for example **wtKG**. Next, Expression to compute: <strong>wt*453.6</strong>. Click OK.

--

```{r comment=NA, echo=F}

cor(mtcars$mpg, mtcars$wt*453.6)

```

--

*d)* Interpret the correlation coefficient between **wt** and **mpg**.

--

- There is a strong negative linear association between cars' weight and fuel efficiency. As a result, heavier cars will yield poor gas mileage in general.


---





